(function(){var $$=this,$=this.IntelliFactory.Runtime,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;$.Define($$,{YC:{BioGraph:{Client:{ChooseDefaultControl:function(C){var D;D=b.Do();return D.Delay(function(){var F,G,H,I,J,K;F=c.Select(0,C);G=d.WithTextLabel("Choose default",F);H=g.getFormSize(30,210);I=H[0];J=H[1];K=g.setFormSize(I,J,"select",G);return D.Bind(d.WithFormContainer(K),function(L){return D.Return(L);});});},FileControl:$.Field(function(){var M,_0;M=function(){var O,P,Q,R,X,Y;O=i.New();P=j.ofArray([m.Attr().NewAttr("type","file"),m.Attr().NewAttr("accept","text/*")]);Q=n.Tags().NewTag("input",P);R=function(S){return function(){var U,V;U=S.Dom.files.item(0);V=new o();V.readAsText(U);return V.addEventListener("load",function(){return O.event.Trigger($.New(s,{$:0,$0:V.result}));},true);};};t.Events().OnChange(R,Q);X=Q;Y=function(){X.set_Value("");return O.event.Trigger($.New(s,{$:0,$0:""}));};return[X,Y,O.event];};_0=b.BuildFormlet(M);return b.InitWith("",_0);}),InputControl:function(_1,_2){var _3,_4,bg,bh;_3=b.Do();_4=_3.Delay(function(){var _6;_6=b.Do();return _3.Bind(_6.Delay(function(){return _6.Bind(g.FileControl(),function(_8){return _6.ReturnFrom(g.ChooseDefaultControl($.New(u,{$:1,$0:["",_8],$1:_2})));});}),function(_9){var _,ba,bb,bc,bd,be;_=c.TextArea(_9);ba=d.WithTextLabel(_1,_);bb=d.WithLabelAbove(ba);bc=g.getFormSize(85,500);bd=bc[0];be=bc[1];return _3.Bind(g.setFormSize(bd,be,"textarea",bb),function(bf){return _3.Return(bf);});});});bg=b.FlipBody(_4);bh=b.Vertical(bg);return d.WithFormContainer(bh);},Main:function(){var bh;bh=j.ofArray([g.frm().Run(function(){return null;})]);return n.Tags().NewTag("div",bh);},OutputControl:function(bj){var bk,bl,bA;bk=b.Do();bl=bk.Delay(function(){var bn,bo;bn=c.Checkbox(false);bo=d.WithTextLabel("wrap",bn);return bk.Bind(d.WithLabelLeft(bo),function(bp){var bq,br,bu,bv,bw,bx,by;bq=bp?"soft":"off";br=b.OfElement(function(){var bt;bt=j.ofArray([m.Attr().NewAttr("readonly","readonly"),m.Attr().NewAttr("wrap",bq),n.Tags().text(bj)]);return n.Tags().NewTag("textarea",bt);});bu=d.WithTextLabel("Output",br);bv=d.WithLabelAbove(bu);bw=g.getFormSize(85,500);bx=bw[0];by=bw[1];return bk.Bind(g.setFormSize(bx,by,"textarea",bv),function(bz){return bk.Return(bz);});});});bA=d.WithFormContainer(bl);return b.FlipBody(bA);},RangeControl:$.Field(function(){var bB,bE,bM,bU,bV,bW;bE=b.Do();bM=b.Do();bB=v.$(v.$(b.Return(function(bC){return function(bD){return[bC<<0,bD<<0];};}),bE.Delay(function(){var bG,bH,bI,bJ,bK;bG=c.Input("");bH=d.WithTextLabel("from",bG);bI=g.getFormSize(30,210);bJ=bI[0];bK=bI[1];return bE.Bind(g.setFormSize(bJ,bK,"input",bH),function(bL){return bE.Return(bL);});})),bM.Delay(function(){var bO,bP,bQ,bR,bS;bO=c.Input("");bP=d.WithTextLabel("to",bO);bQ=g.getFormSize(30,210);bR=bQ[0];bS=bQ[1];return bM.Bind(g.setFormSize(bR,bS,"input",bP),function(bT){return bM.Return(bT);});}));bU=b.Horizontal(bB);bV=d.WithTextLabel("String range",bU);bW=d.WithLabelAbove(bV);return d.WithFormContainer(bW);}),ShowImageControl:function(bX,bY){var bZ,b0,b1,b2,b3,b7,b8;bZ=[bX,bY];if(bZ[0].$==1){if(bZ[1]){bZ[0].$0;b2="graphImg.svg";}else{bZ[0].$0;b2="defaultImg.svg";}b1=b2;}else{b1=bZ[1]?"defaultImg.svg":"defaultImg.svg";}b0=b1;b3=b.OfElement(function(){var b5,b6;b5="height: "+(g.getFormSize(355,355))[0]+"; width: "+(g.getFormSize(355,355))[0];b6=j.ofArray([m.Attr().NewAttr("style",b5),m.Attr().NewAttr("src",b0)]);return n.Tags().NewTag("img",b6);});b7=d.WithTextLabel("Graph visualisation",b3);b8=d.WithLabelAbove(b7);return d.WithFormContainer(b8);},frm:$.Field(function(){var b9,b_,cd,cf,cg,ci,cj,ck,cl,cm,cn,co,cp,cq,cN,cO;b9="background-color: #FF1493; border-width: 3px; border-color: #000000; height: "+(g.getFormSize(40,80))[0]+"; width: "+(g.getFormSize(40,80))[1]+"; font-size:"+(g.getFormSize(30,80))[0];cd=function(ce){return[ce,x.Sync("YC.BioGraph:1",[{$:1},ce])];};cf=x.Sync("YC.BioGraph:0",[{$:1}]);cg=function(ch){return[ch,x.Sync("YC.BioGraph:1",[{$:0},ch])];};ci=x.Sync("YC.BioGraph:0",[{$:0}]);cj=c.Checkbox(false);ck=d.WithTextLabel("DRAW GRAPH",cj);cl=d.WithLabelLeft(ck);b_=v.$(v.$(v.$(v.$(b.Return(function(b$){return function(ca){return function(cb){return function(cc){return[b$,ca,cb,cc];};};};}),g.InputControl("Grammar",j.map(cd,cf))),g.InputControl("Graph",j.map(cg,ci))),g.RangeControl()),d.WithFormContainer(cl));cm=y.get_Default();cn=$.New(y,{Label:{$:1,$0:"GO"},Style:{$:1,$0:b9},Class:cm.Class});co=d.WithCustomSubmitButton(cn,b_);cp=b.Vertical(co);cq=function(cr){var cs,ct,cu,cv,cw,cx;cs=cr[0];ct=cr[1];cu=cr[2];cv=cr[3];cw=b.Do();cx=cw.Delay(function(){var cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK;cz=cu[0];cA=cu[1];cB=x.Sync("YC.BioGraph:2",[cs,ct,cz,cA,cv]);if(cB.$==1){cE=cB.$1;cF=cB.$0;if(cF.$==1){cH=cF.$0;cG=[{$:1,$0:cH},z.Join("/n",cE)];}else{cG=[{$:0},z.Join("/n",cE)];}cD=cG;}else{cI=cB.$0;cD=[{$:0},cI];}cC=cD;cJ=cC[1];cK=cC[0];return cw.Bind(g.ShowImageControl(cK,cv),function(){return cw.Bind(g.OutputControl(cJ),function(cM){return cw.Return(cM);});});});return b.Vertical(cx);};cN=b.Do();cO=cN.Delay(function(){return cN.Bind(cp,function(cQ){return cN.Bind(cq(cQ),function(cR){return cN.Return([cQ,cR]);});});});return b.Horizontal(cO);}),getFormSize:function(cS,cT){var cU,cV;cU=cS*g.screenHeight()/648>>0;cV=cT*g.screenWidth()/1366>>0;return[A(cU)+"px",A(cV)+"px"];},screenHeight:$.Field(function(){return B("html").height();}),screenWidth:$.Field(function(){return B("html").width();}),setFormSize:function(cW,cX,cY,cZ){var c0;c0=function(c1){B(c1.Dom.querySelector(cY)).css("height",cW).css("width",cX);return c1;};return b.MapElement(c0,cZ);}}}}});$.OnInit(function(){a=$.Safe($$.WebSharper.Formlets);b=$.Safe(a.Formlet);c=$.Safe(a.Controls);d=$.Safe(a.Enhance);e=$.Safe($$.YC);f=$.Safe(e.BioGraph);g=$.Safe(f.Client);h=$.Safe($$.WebSharper.Control);i=$.Safe(h.FSharpEvent);j=$.Safe($$.WebSharper.List);k=$.Safe($$.WebSharper.Html);l=$.Safe(k.Client);m=$.Safe(l.Attr);n=$.Safe(l.Tags);o=$.Safe($$.FileReader);p=$.Safe($$.IntelliFactory);q=$.Safe(p.Formlets);r=$.Safe(q.Base);s=$.Safe(r.Result);t=$.Safe(l.EventsPervasives);u=$.Safe(j.T);v=$.Safe(a.Data);w=$.Safe($$.WebSharper.Remoting);x=$.Safe(w.AjaxRemotingProvider);y=$.Safe(d.FormButtonConfiguration);z=$.Safe($$.WebSharper.Strings);A=$.Safe($$.String);return B=$.Safe($$.jQuery);});$.OnLoad(function(){g.screenWidth();g.screenHeight();g.frm();g.RangeControl();g.FileControl();return;});}());
